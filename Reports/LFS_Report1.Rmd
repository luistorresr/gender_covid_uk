---
title: 'Impacts of COVID-19 on employment trends in the UK: Exploring gender, ethinicity
  and class'
author: "Luis D. Torres, Annegreet Veeken and Tracey Warren, University of Nottingham"
output: 
  word_document:
    reference_docx: "Report_template1.docx"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
	warning = FALSE,
  collapse = TRUE)

### R version
# R version 4.0.4

### R version
# R 4.0 or above

#### packages needed
if(!require(tidyverse)) install.packages("tidyverse", repos = "http://cran.us.r-project.org")
if(!require(gridExtra)) install.packages("girdExtra", repos = "http://cran.us.r-project.org")
if(!require(corrr)) install.packages("corrr", repos = "http://cran.us.r-project.org")
if(!require(Hmisc)) install.packages("Hmisc", repos = "http://cran.us.r-project.org")
if(!require(sjlabelled)) install.packages("sjlabelled", repos = "http://cran.us.r-project.org")
if(!require(ggthemes)) install.packages("ggthemes", repos = "http://cran.us.r-project.org")
if(!require(ggtext)) install.packages("ggtext", repos = "http://cran.us.r-project.org")
if(!require(ggrepel)) install.packages("ggrepel", repos = "http://cran.us.r-project.org")
if(!require(doBy)) install.packages("doBy", repos = "http://cran.us.r-project.org")
if(!require(sjmisc)) install.packages("sjmisc", repos = "http://cran.us.r-project.org")
if(!require(plotly)) install.packages("plotly", repos = "http://cran.us.r-project.org")
if(!require(flextable)) install.packages("flextable", repos = "http://cran.us.r-project.org")
if(!require(scales)) install.packages("scales", repos = "http://cran.us.r-project.org")
if(!require(ggalt)) install.packages("ggalt", repos = "http://cran.us.r-project.org")
if(!require(janitor)) install.packages("janitor", repos = "http://cran.us.r-project.org")

library(ggalt) # contingency table
library(tidyverse) # several tools for data manipulation
library(haven) # read SPSS, Stata, and SAS data
library(gridExtra) # arrange multiple grid-based plots on a page
library(corrr) # for correlations correlate()
library(Hmisc) # many functions useful for data analysis
library(sjmisc) # useful to set Na's
library(sjlabelled) # get_labels function
library(ggthemes) # themes for ggplot2
library(ggtext) # fancy text
library(ggrepel) # help with the position of the labels on ggplot2 graph
library(doBy) # 'do' something to data stratified 'by' some variables
library(plotly) # interactive plots
library(flextable) # formatting tables 
library(scales) # add scale symbols and colour to axis
library(janitor) # add totals to tables

#### Output configurations
options(digits = 3) # decimal points to 3
```

## Introduction

The COVID-19 outbreak has substantial consequences for men and women's working lives. Generally economic recessions affect men's employment the most, but this is not a typical recession. Measures adopted by businesses and governments, such as flexible working and the job retention scheme, may be mitigating the impacts of the pandemic in ways not comparable to previous social and economic crises.

However, the lockdowns and social distancing measures may be having a unequal impact on jobs frequently done by women. Women have been historically more limited in their choices for employment, they are more likely to work under vulnerable conditions, and they are over-represented in mid-skill occupations. When women have access to paid employment, they tend to work in more unstable and precarious conditions than men.

Therefore, we ask if the pandemic is narrowing or reinforcing inequalities in employment. To answer this question we use the UK's largest study on employment circumstances, the Labour Force Survey. More specifically, we ask how employment rates have differed between men and women of different ethnic background, age and class during the pandemic.

The focus on these characteristics has a simple reason, our understanding of inequalities. Any quantifiable aspect that differs across individuals or social groups can be called an inequality. This is a descriptive observation which lacks of any moral judgement. In analysing the possible injustice of an inequality, it is necessary to establish that the inequality is avoidable, unnecessary and unfair. This requires an analysis of individual circumstances, individual choice and social advantage.

## Methodology

This report draws on the analysis of the 2020/21 releases of the UK Labour Force Survey (LFS). Respondents are interviewed for five successive waves at three-months intervals and approximately 20% of the sample is replaced every quarter. Four quarters releases are supported in a typical year: Jan-Mar \| Apr-Jun \| Jul-Sep \| Oct-Dec. From 2020, additional non-calendar quarter data has been released as a response to the need of data in the context of the coronavirus pandemic. Besides the four calendar quarters per year, 2020 included another eight releases of data. The last two quarters included data for January and February 2021.

Our analyses consider only the economically active population between 18-64 years old.

```{r data, echo=FALSE}

load("../Data_clean/LFS_clean.rda")

N_total <- LFS_clean %>%
        filter(AGE >= 18 & AGE <= 64) %>%
        group_by(as_label(QUARTER)) %>%
        summarise(Sample = n(), Population = sum(PWT18)) 

N_active <- LFS_clean %>% 
        filter(AGE >= 18 & AGE <= 64 & ILODEFR <=2) %>%
        group_by(as_label(QUARTER)) %>%
        summarise(Econ_active = sum(PWT18))

N_total <- left_join(N_total, N_active, by = "as_label(QUARTER)")  

N_total %>% 
        flextable() %>% theme_vanilla() %>%
        set_caption(caption = "Sample size and population estimates", style = "table") %>%
        bold(bold = TRUE, part = "header") %>%
        set_header_labels(`as_label(QUARTER)` = "Quarter",
                          Population = "Population Estimate",
                          Econ_active = "Economically Active") %>%
        autofit() %>%
        align_nottext_col(align = "center", header = TRUE, footer = FALSE) %>%
        add_footer_lines("Notes: Individuals between 18-64 years old") %>%
        add_footer_lines("Source: UK Labour Force Survey (Person)") %>%
        color(part = "footer", color = "#666666") 

```

## Gender impact of COVID-19 on employment

### Men's employment hit the most

As with previous economic recessions, the impact of COVID-19 hit men's employment the most. Unemployment increased dramatically after the first lockdown with a peach during summer 2020. From September-November quarter both men and women's employment had showed signs of stabilisation.

```{r unemployment, echo=FALSE, fig.width= 8, fig.height=7}
# Unemployment per sex

unem_sex <- LFS_clean %>% 
                filter(AGE >= 18 & AGE <= 64 & ILODEFR <=2) %>%
                group_by(QUARTER, as_label(ILODEFR), SEX) %>%
                summarise(Active = sum(PWT18))  %>% 
            pivot_wider(names_from = `as_label(ILODEFR)`, values_from = Active) %>%
            adorn_totals("col") %>%
            mutate(Rate = `Not employed` / Total) # unemployment rates per gender 

unem_sex %>% 
        ggplot(aes(x = QUARTER, y = Rate, col = as_label(SEX))) +
        geom_line(size = 1, show.legend = FALSE) +
        geom_point(shape = 19) + 
        geom_vline(xintercept = 3, linetype="dotted") +
  
        #scales
        scale_colour_manual(values = c("#DF9216", "#791F83")) +
        scale_y_continuous(breaks = seq(0,0.06, 0.01), limits = c(0, 0.06), labels = label_percent()) +
        scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
                         labels=c("Jan-Mar20", "Feb-Apr20", "Mar-May20", "Apr-Jun20", "May-Jul20", 
                                  "Jun-Aug20", "Jul-Sep20","Aug-Oct20", "Sep-Nov20", "Oct-Dec20",
                                  "Nov20-Jan21", "Dec20-Feb21")) +
        # annotation
        labs(x = "", 
             y = "",
             title ="Men's employment hit the most by the COVID-19 pandemic",
             subtitle  = "Unemployment rate of UK population  2020-2021",
             caption = c("Source: UK Labour Force Survey (Person)")) +
        annotate(geom = "text", x = 12, y = 0.053, label = "Men", color= "#DF9216") +
        annotate(geom = "text", x = 12, y = 0.040, label = "Women", color= "#791F83") +

        # theme
        theme_economist_white(gray_bg = FALSE) +
        theme(plot.title = element_text(face = "bold",
                                        margin = margin(10, 0, 10, 0),
                                        size = 13),
              axis.text.x=element_text(angle=90),
              axis.title.x = element_text(margin = margin(t = 5), vjust = 0, size = 10),
              axis.title.y = element_text(margin = margin(r = 3), vjust = 2, size = 10), 
              axis.text = element_text(size = 11),
              legend.position = "none",
              legend.title = element_blank()) 

```

This overall trend is useful to understand the extent of the COVID-19 impact on employment as well as the quarters where those impacts where felt the most. However, the trend does not account for the diversity of the UK population in terms of, age, ethnicity, and economic status. We further explore these factors in the following sections.

### Highest job loss among young people

When age groups are considered, the unemployment trend shows concerning levels for people between 18 and 24 years old. Unemployment reached over 17% for men and 12% for women in Summer 2020.

Employment showed signed of recovery after this peak. While men's employment started to show signs of recovery in the period August-October, job loss for women remained constant until September-November quarter.

```{r age, echo=FALSE, fig.width= 8, fig.height=7}

unem_age <- LFS_clean %>% 
        filter(AGE >= 18 & AGE <= 64 & ILODEFR <=2) %>%
        group_by(QUARTER, as_label(ILODEFR), SEX, AGEEUL_2) %>%
        summarise(Active = sum(PWT18))  %>% 
        pivot_wider(names_from = `as_label(ILODEFR)`, values_from = Active) %>%        
        adorn_totals("col") %>%
        mutate(Rate = `Not employed` / Total)

age_select <- unem_age %>% filter(AGEEUL_2 == 2)

unem_age %>%       
        # select data
        select(QUARTER, AGEEUL_2, SEX, Rate) %>%  
        filter(!is.na(Rate))  %>% 
        arrange(desc(Rate)) %>%
        
        # graphic type and variables 
        ggplot(aes(x = QUARTER, y = Rate, col= as_label(SEX))) +
        geom_point(aes(size=Rate, alpha=0.5)) +  
        geom_encircle(data = age_select, aes(x = QUARTER, y = Rate)) +
        geom_vline(xintercept = 3, linetype="dotted") +
        annotate(geom = "text", x = 11, y = 0.19, label = "Men aged 18-24", color= "#DF9216") +
        annotate(geom = "text", x = 11, y = 0.080, label = "Women aged 18-24", color= "#791F83") +
        
        #scales
        scale_colour_manual(values = c("#DF9216", "#791F83")) +
        scale_y_continuous(breaks = seq(0,0.20, 0.02), limits = c(0,0.20), labels = label_percent()) +
        scale_x_continuous(breaks=c(1:12),
                         labels=c("Jan-Mar20", "Feb-Apr20", "Mar-May20", "Apr-Jun20", "May-Jul20", 
                                  "Jun-Aug20", "Jul-Sep20","Aug-Oct20", "Sep-Nov20", "Oct-Dec20",
                                  "Nov20-Jan21", "Dec20-Feb21")) + 
        # annotation
        labs(x = "", 
        y = "",
         title ="Highest job loss for young people",
        subtitle  = "Unemployment rate of UK population, 2020-2021",
        caption = c("Source: UK Labour Force Survey (Person)")) +
        
        # theme
        theme_economist_white(gray_bg = FALSE) +
        theme(plot.title = element_text(face = "bold",
                                        margin = margin(10, 0, 10, 0),
                                        size = 13),
              axis.text.x=element_text(angle=90),
              axis.title.x = element_text(margin = margin(t = 5), vjust = 0, size = 10),
              axis.title.y = element_text(margin = margin(r = 3), vjust = 2, size = 10), 
              axis.text = element_text(size = 11),
              legend.position = "none",
              legend.title = element_blank(),
              legend.text = element_text(size=10),
              strip.text = element_text(face = "bold", hjust = 0, size = 11)) +
        guides(color = guide_legend(override.aes = list(size = 3))) 

```

### People from non-white backgrounds have been hit the most

When ethnic background is taken into account, the gender gap against male employment seems less homogeneous than the overall trend. While unemployment for people from White background has remained well below 6% and against men, job losses for other minorities have fluctuated beyond 6% each quarter and with differential gender impacts.

Men from mixed/multiple backgrounds have seen a sharp rise in their unemployment up to 15% in June-August. Female unemployment has remained constant below 6% for most quarters, but it has reached 11% in the last two quarters getting closer to male rates.

A similar but less marked gender trend has been felt by people from black backgrounds. Unemployment increased to over 10% from June-August for men and women with fluctuation between 10% to 14% for the rest of the year. While the last quarter showed a drastic fall for men, women's unemployment remained constant at 12%.

For most groups COVID-19 has worsen pre-pandemic gender gaps. For example, women from Indian, non-Chinese Asian, and other ethnic background suffered from lower employment since before the pandemic hit. However, some ethnic minorities have showed a particularly unstable and contrasting gender trend. This is the case of the Pakistani, Bangladeshi, and Chinese.

-   Pakistani women saw a short fall in unemployment during May-July to pre-pandemic levels. However, women's job losses increased sharply to a peak of 18% in September-November, while men's remained below 9%. Only in December-February women's unemployment fell to men's levels.
-   Job loss showed a contrasting trend form Bangladeshi men and women. While women experienced a continuous fall in unemployment from the start of the pandemic until June-August, men saw an increase until the same quarter. The following three periods the trend shows and increase for women and a decrease for men. This changes in the last two quarters.
-   Unemployment for Chinese people has been unstable particularly for men from the start of the pandemic to the period between August-October when stabilise below 6%. Women's unemployment, on the other hand, has doubled in the same period.

For most ethnic groups, but the Bangladeshi, the COVID-19 pandemic has had a negative impact on employment. Employment seems to be recovering in the last couple of quarters particularly for women. However, this is not the case for mixed/multiple and other ethnic groups who continue experiencing a rise in job losses.

```{r ethnicity, echo=FALSE, fig.width= 9, fig.height=8}

# Unemployment per ethnicity and sex

unem_eth <- LFS_clean %>% 
        filter(AGE >= 18 & AGE <= 64 & ILODEFR <=2) %>%
        group_by(QUARTER, as_label(ILODEFR), SEX, ETHUKEUL) %>%
        summarise(Active = sum(PWT18))  %>% 
        pivot_wider(names_from = `as_label(ILODEFR)`, values_from = Active) %>%
        adorn_totals("col") %>%
        mutate(Rate = `Not employed` / Total)

unem_eth %>% 
        # select data
        select(QUARTER, ETHUKEUL, SEX, Rate) %>% 
        filter(!is.na(Rate & ETHUKEUL)) %>% 
       
         # graphic type and variables 
        ggplot(aes(x = QUARTER, y = Rate, col = as_label(SEX))) +
        geom_line(size = 1, show.legend = FALSE) +
        geom_point(shape = 19) +  
        geom_vline(xintercept = 3, linetype="dotted") +
        facet_wrap(.~as_label(ETHUKEUL), ncol = 3) +
        
        #scales
        scale_colour_manual(values = c("#DF9216", "#791F83")) +
        scale_y_continuous(breaks = seq(0,0.2, 0.02), limits = c(0,0.2), labels = label_percent()) + 
        scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
                         labels=c("Jan-Mar20", "Feb-Apr20", "Mar-May20", "Apr-Jun20", "May-Jul20", 
                                  "Jun-Aug20", "Jul-Sep20","Aug-Oct20", "Sep-Nov20", "Oct-Dec20",
                                  "Nov20-Jan21", "Dec20-Feb21")) +
        # annotation
        labs(x = "", 
             y = "",
             title ="Highest job loss in people from non-white backgrounds",
             subtitle  = "Unemployment rate of UK population, 2020-2021",
             caption = c("Source: UK Labour Force Survey (Person)")) +

        # theme
        theme_economist_white(gray_bg = FALSE) +
        theme(plot.title = element_text(face = "bold",
                                        margin = margin(10, 0, 10, 0),
                                        size = 13),
              axis.text.x=element_text(angle=90),
              axis.title.x = element_text(margin = margin(t = 5), vjust = 0, size = 10),
              axis.title.y = element_text(margin = margin(r = 3), vjust = 2, size = 10), 
              axis.text = element_text(size = 9),
              legend.position = "top",
              legend.title = element_blank(),
              legend.text = element_text(size=11),
              strip.text = element_text(face = "bold", hjust = 0, size = 10)) +
        guides(color = guide_legend(override.aes = list(size = 3))) 

```

It is important to notice that the LFS responses are weighted to official population projections that pre-date the COVID-19 pandemic. This particularly affects estimates for ethnicity estimates. This implies that levels and differences in levels should be used with caution. Despite this, sample level estimates show a similar trend regarding gender differences for each group.

### Highest job loss in routine and semi routine occupations

This trend is particularly explained by the job losses in routine and semi routine occupations. Typical occupations here include cleaners, drivers, assemblers, machine operators, porters and messengers, plumbers, shop workers and care workers.

```{r occupation, echo=FALSE, fig.width= 8, fig.height=6, eval=FALSE}

# Unemployment per occupation and sex

unem_class <- LFS_clean %>% 
        filter(AGE >= 18 & AGE <= 64 & ILODEFR <=2) %>%
        group_by(QUARTER, as_label(ILODEFR), SEX, NSECMJ10_2) %>%
        summarise(Active = sum(PWT18))  %>% 
        pivot_wider(names_from = `as_label(ILODEFR)`, values_from = Active) %>%
        adorn_totals("col") %>%
        mutate(Rate = `Not employed` / Total) 

unem_class %>% 
        # select data
        select(QUARTER, NSECMJ10_2, SEX, Rate) %>%  
        filter(!is.na(Rate & NSECMJ10_2) & NSECMJ10_2 <=5)  %>% 
        # graphic type and variables 
        ggplot(aes(x = QUARTER, y = Rate, fill = as_label(NSECMJ10_2))) +
        geom_area() +
        facet_wrap(~as_label(SEX)) +
        #scales
        scale_y_continuous(breaks = seq(0,0.18, 0.02), limits = c(0,0.18), labels = label_percent()) +
        scale_fill_manual(values = c("#FC8DB7", "#791F83", "#006295", "#DF9216","#A3BE41", "#999999")) +
        scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"),
                         labels=c("Jan-Mar20", "Feb-Apr20", "Mar-May20", "Apr-Jun20", "May-Jul20", 
                                  "Jun-Aug20", "Jul-Sep20","Aug-Oct20", "Sep-Nov20", "Oct-Dec20",
                                  "Nov20-Jan21", "Dec20-Feb21")) +
        # annotation
        labs(x = "", 
             y = "",
             title ="Highest job loss in routine and semi routine occupations",
             subtitle  = "Unemployment rate of UK population, 2020-2021",
             caption = "Source: UK Labour Force Survey (Person)") +
        
        # theme
        theme_economist_white(gray_bg = FALSE) +
        theme(plot.title = element_text(face = "bold",
                                        margin = margin(10, 0, 10, 0),
                                        size = 13),
              # axis.text.x=element_blank(),
              axis.text.x=element_text(angle=90),
              axis.title.x = element_text(margin = margin(t = 5), vjust = 0, size = 10),
              axis.title.y = element_text(margin = margin(r = 3), vjust = 2, size = 10), 
              axis.text = element_text(size = 9),
              legend.position = "top",
              legend.key.width = unit(0.5,"cm"),
              legend.margin = margin(1, 0, 1, 0, "cm"),
              legend.title = element_blank(),
              legend.text = element_text(size=10),
              strip.text = element_text(face = "bold", hjust = 0, size = 11)) + 
              guides(fill=guide_legend(nrow=2,byrow=TRUE))
```

### Maybe some predictive modelling here

to be continue 1..

# Conclusions

to be continue 2..
